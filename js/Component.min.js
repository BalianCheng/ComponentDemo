///<jscompress sourcefile="content.js" />
/**
 * Created by Dovahkiin on 2017/4/3.
 *////<jscompress sourcefile="loading.js" />
/**
 * Created by Dovahkiin on 2017/4/7.
 *////<jscompress sourcefile="ComponentBase.js" />
/**
 * Created by Dovahkiin on 2017/4/2.
 *////<jscompress sourcefile="ComponentBar.js" />
/**
 * Created by Dovahkiin on 2017/4/2.
 *////<jscompress sourcefile="ComponentBar_v.js" />
/**
 * Created by Dovahkiin on 2017/4/5.
 */
/* 垂直柱图组件对象 *////<jscompress sourcefile="ComponentPie.js" />
/**
 * Created by Dovahkiin on 2017/4/5.
 *////<jscompress sourcefile="ComponentRing.js" />
/**
 * Created by Dovahkiin on 2017/4/5.
 */
/* 环图组件对象 *////<jscompress sourcefile="ComponentPoint.js" />
/**
 * Created by Dovahkiin on 2017/4/2.
 *////<jscompress sourcefile="ComponentPolyline.js" />
/**
 * Created by Dovahkiin on 2017/4/5.
 *////<jscompress sourcefile="ComponentRadar.js" />
/**
 * Created by Dovahkiin on 2017/4/5.
 */var jData=[],Content=function(){this.id=("Cont_"+Math.random()).replace(".","_");this.el=$('\x3cdiv class\x3d"Content" id\x3d"'+this.id+'"\x3e\x3c/div\x3e').hide();this.page=[];$("body").append(this.el);this.addPage=function(f,b){jData.push({isPage:!0,name:f,text:b});var d=$('\x3cdiv class\x3d"page section"\x3e\x3c/div\x3e');void 0!=f&&d.addClass("page_"+f);void 0!=b&&d.html(b);this.el.append(d);this.page.push(d);"function"===typeof this.whenAddPage&&this.whenAddPage();return this};this.addComponent=function(f,b){jData.push({isPage:!1,name:f,cfg:b});b=b||{};b=$.extend({type:"base"},b);var d,h=this.page.slice(-1)[0];switch(b.type){case "base":d=new ComponentBase(f,b);break;case "polyline":d=new ComponentPolyline(f,b);break;case "pie":d=new ComponentPie(f,b);break;case "bar":d=new ComponentBar(f,b);break;case "bar_v":d=new ComponentBar_v(f,b);break;case "radar":d=new ComponentRadar(f,b);break;case "pie":d=new ComponentPie(f,b);break;case "ring":d=new ComponentRing(f,b);break;case "point":d=new ComponentPoint(f,b)}h.append(d);return this};this.loader=function(f){this.el.fullpage({onLeave:function(b,d,h){$(this).find(".component").trigger("onLeave")},afterLoad:function(b,d){$(this).find(".component").trigger("afterLoad")}});this.page[0].find("component").trigger("afterLoad");this.el.show();f&&$.fn.fullpage.moveTo(f)};this.loader="function"==typeof Content_loading?Content_loading:this.loader;return this},Content_loading=function(f,b){var d=this.id;if(void 0===this._images){this._images=(f||[]).length;this._load=0;window[d]=this;for(var h in f){var e=f[h],c=new Image;c.onload=function(){window[d].loader()};c.src=e}$("#rate").text("0%");return this}this._load++;$("#rate").text((this._load/this._images*100>>0)+"%");if(this._load<this._images)return this;window[d]=null;this.el.fullpage({onLeave:function(a,b,c){$(this).find(".component").trigger("onLeave")},afterLoad:function(a,b){$(this).find(".component").trigger("afterLoad")}});this.page[0].find("component").trigger("afterLoad");this.el.show();b&&$.fn.fullpage.moveTo(b)},ComponentBase=function(f,b){b=b||{};var d=("Cpt_"+Math.random()).replace(".","_"),h="Cpt_"+b.type,e=$('\x3cdiv class\x3d"component '+h+" component_name_"+f+'" id\x3d"'+d+'"\x3e\x3c/div\x3e');b.text&&e.text(b.text);b.width&&e.width(b.width/2);b.height&&e.height(b.height/2);b.css&&e.css(b.css);b.bg&&e.css("backgroundImage","url("+b.bg+")");!0===b.center&&e.css({marginLeft:b.width/4*-1+"px",left:"50%"});if("function"===typeof b.onclick)e.on("click",b.onclick);e.on("afterLoad",function(){setTimeout(function(){e.addClass(h+"_load").removeClass(h+"_leave");b.animateIn&&e.animate(b.animateIn)},b.delay||0);return!1});e.on("onLeave",function(){setTimeout(function(){e.addClass(h+"_leave").removeClass(h+"_load");b.animateOut&&e.animate(b.animateOut)},b.delay||0);return!1});return e},ComponentBar=function(f,b){var d=new ComponentBase(f,b);$.each(b.data,function(b,e){var c=$('\x3cdiv class\x3d"line"\x3e\x3c/div\x3e'),a=$('\x3cdiv class\x3d"name"\x3e\x3c/div\x3e'),g=$('\x3cdiv class\x3d"rate"\x3e\x3c/div\x3e'),h=$('\x3cdiv class\x3d"per"\x3e\x3c/div\x3e'),f=100*e[1]+"%",p="";e[2]&&(p='style\x3d"background-color:'+e[2]+'"');g.css("width",f);g.html('\x3cdiv class\x3d"bg"'+p+"\x3e\x3c/div\x3e");a.text(e[0]);c.append(a).append(g).append(h);h.text(f);d.append(c)});return d},ComponentBar_v=function(f,b){var d=new ComponentBar(f,b),h=100/b.data.length>>0;d.find(".line").width(h+"%");$.each(d.find(".rate"),function(){var b=$(this).css("width");$(this).height(b).width("")});$.each(d.find(".per"),function(){$(this).appendTo($(this).prev())});return d},ComponentPie=function(f,b){var d=new ComponentBase(f,b),h=b.width,e=b.height,c=document.createElement("canvas"),a=c.getContext("2d");c.width=a.width=h;c.height=a.height=e;$(c).css("zIndex",1);d.append(c);var g=h/2;a.beginPath();a.fillStyle="##282828";a.strokeStyle="##282828";a.lineWidth=1;a.arc(g,g,g,0,2*Math.PI);a.fill();a.stroke();c=document.createElement("canvas");a=c.getContext("2d");c.width=a.width=h;c.height=a.height=e;$(c).css("zIndex",2);d.append(c);for(var c="black blue green cyan gery orange".split(" "),l=1.5*Math.PI,k=0,p=2*Math.PI,m=b.data.length,r=0;r<m;r++){var t=b.data[r],k=l+p*t[1],n=t[2]||(t[2]=c.pop());a.beginPath();a.fillStyle=n;a.strokeStyle=n;a.lineWidth=.1;a.moveTo(g,g);a.arc(g,g,g,l,k);a.fill();a.stroke();l=k;n=$('\x3cdiv class\x3d"text"\x3e\x3c/div\x3e');n.text(t[0]);var q=$('\x3cdiv class\x3d"per"\x3e\x3c/div\x3e');q.text(100*t[1]+"%");n.append(q);q=g+Math.sin(.5*Math.PI-l)*g;k=g+Math.cos(.5*Math.PI-k)*g;q>=h/2?n.css("left",q/2):n.css("right",(h-q)/2);k>=e/2?n.css("top",k/2):n.css("bottom",(e-k)/2);t[2]&&n.css("color",t[2]);n.css("transition","all .5s "+.2*r+"s");n.css("opacity",0);d.append(n)}c=document.createElement("canvas");a=c.getContext("2d");c.width=a.width=h;c.height=a.height=e;$(c).css("zIndex",3);d.append(c);a.fillStyle="#2c2c2c";a.strokeStyle="#2c2c2c";a.lineWidth=1;var l=1.5*Math.PI,u=function(b){a.clearRect(0,0,h,e);a.beginPath();a.moveTo(g,g);0>=b?(a.arc(g,g,g,0,p),d.find(".text").css("opacity",0)):a.arc(g,g,g,l,l+p*b,!0);a.fill();a.stroke();1<=b&&(d.find(".text").css("transition","all 0s"),ComponentPie.reSort(d.find(".text")),d.find(".text").css("transition","all 1s"),d.find(".text").css("opacity",1))};u(0);d.on("afterLoad",function(){for(var a=0,b=0;100>b;b++)setTimeout(function(){a+=.01;u(a)},10*b)});d.on("onLeave",function(){for(var a=1,b=0;100>b;b++)setTimeout(function(){a-=.01;u(a)},10*b)});return d};ComponentPie.reSort=function(f){var b=function(b,d){var c=$(b).offset,a=$(d).offset,e=[c.left,$(b).width()+c.left],h=[c.top,$(b).height()+c.top],c=[a.left,$(d).width()+a.left],a=[a.top,$(d).height()+a.top],a=h[0]>a[0]&&h[0]<a[1]||h[1]>a[0]&&h[1]<a[1];return(e[0]>c[0]&&e[0]<c[1]||e[1]>c[0]&&e[1]<c[1])&&a},d=[f[0]];$.each(f,function(h,e){b(d[d.length-1],e)&&d.push(e);1<d.length&&($.each(d,function(b,a){if(d[b+1]){var c=d[b+1];"auto"!=$(a).css("top")&&$(a).css("top",parseInt($(a).css("top"))+$(c).height());"auto"!=$(a).css("bottom")&&$(a).css("bottom",parseInt($(a).css("bottom"))+$(c).height())}}),ComponentPie.reSort(d))})};var ComponentRing=function(f,b){1<b.data.length&&(b.data=[b.data[0]]);b.type="pie";var d=new ComponentPie(f,b);d.addClass("Cpt_ring");var h=$('\x3cdiv class\x3d"mask"\x3e');d.append(h);var e=d.find(".text");e.attr("style","");b.data[0][2]&&e.css("color",b.data[0][2]);h.append(e);return d},ComponentPoint=function(f,b){var d=new ComponentBase(f,b),h=b.data[0][1];$.each(b.data,function(b,c){var a=$('\x3cdiv class\x3d"point point_'+b+'"\x3e\x3c/div\x3e'),e=$('\x3cdiv class\x3d"name"\x3e'+c[0]+"\x3c/div\x3e"),f=$('\x3cdiv class\x3d"per"\x3e'+100*c[1]+"%\x3c/div\x3e"),k=c[1]/h*100+"%";e.append(f);a.append(e);a.width(k).height(k);c[2]&&a.css("background-color",c[2]);void 0!==c[3]&&void 0!==c[4]&&a.css("left",c[3]).css("top",c[4]);d.append(a)});d.find(".point").on("click",function(){d.find(".point").removeClass("point_focus");$(this).addClass("point_focus");return!1});d.find(".point").on("mouseover",function(){d.find(".point").removeClass("point_focus");$(this).addClass("point_focus");return!1}).eq(0).addClass("point_focus");return d},ComponentPolyline=function(f,b){var d=new ComponentBase(f,b),h=b.width,e=b.height,c=document.createElement("canvas"),a=c.getContext("2d");c.width=a.width=h;c.height=a.height=e;d.append(c);var g=10;a.beginPath();a.lineWidth=1;a.strokeStyle="white";window.ctx=a;for(var l=0;l<g+1;l++)c=e/g*l,a.moveTo(0,c),a.lineTo(h,c);g=b.data.length+1;c=h/g>>0;for(l=0;l<g+1;l++){var k=h/g*l;a.moveTo(k,0);a.lineTo(k,e);if(b.data[l]){var p=$('\x3cdiv class\x3d"text"\x3e\x3c/div\x3e');p.text(b.data[l][0]);p.css("width",c/2).css("left",k/2+c/4);d.append(p)}}a.stroke();c=document.createElement("canvas");a=c.getContext("2d");c.width=a.width=h;c.height=a.height=e;d.append(c);var m=function(c){a.clearRect(0,0,h,e);a.beginPath();a.lineWidth=3;a.strokeStyle="#c5c2c2";var d=0,f,q=h/g+1;for(l in b.data){var k=b.data[l],d=q*l+q;f=e-k[1]*e*c;a.moveTo(d,f);a.arc(d,f,5,0,2*Math.PI)}a.moveTo(0,e);a.lineTo(q,e-b.data[0][1]*e*c);a.moveTo(q,e-b.data[0][1]*e*c);for(l in b.data)k=b.data[l],d=q*l+q,f=e-k[1]*e*c,a.lineTo(d,f);a.lineTo(h,e);a.stroke();a.lineWidth=1;a.strokeStyle="rgba(0,0,0,0)";a.fillStyle="rgba(197,194,194,0.2)";a.lineTo(d,e);a.lineTo(0,e);a.fill();for(l in b.data)k=b.data[l],d=q*l+q,f=e-k[1]*e*c,a.moveTo(d,f),a.fillStyle=k[2]?k[2]:"#595959",a.font="35px Arial",a.fillText((100*k[1]>>0)+"%",d-10,f-10);a.stroke()};d.on("afterLoad",function(){for(var a=0,b=0;100>b;b++)setTimeout(function(){a+=.01;m(a)},10*b+500)});d.on("onLeave",function(){for(var a=1,b=0;100>b;b++)setTimeout(function(){a-=.01;m(a)},10*b+500)});return d},ComponentRadar=function(f,b){var d=new ComponentBase(f,b),h=b.width,e=b.height,c=document.createElement("canvas"),a=c.getContext("2d");c.width=a.width=h;c.height=a.height=e;d.append(c);for(var g=h/2,l=b.data.length,k=!1,p=10;0<p;p--){a.beginPath();for(c=0;c<l;c++){var m=2*Math.PI/360*(360/l)*c,r=g+p/10*g*Math.sin(m),m=g+p/10*g*Math.cos(m);a.lineTo(r,m)}a.closePath();a.fillStyle=(k=!k)?"#696868":"#565858";a.fill()}for(c=0;c<l;c++)m=2*Math.PI/360*(360/l)*c,r=g+Math.sin(m)*g,m=g+Math.cos(m)*g,a.moveTo(g,g),a.lineTo(r,m),b.data[c]&&(k=$('\x3cdiv class\x3d"text"\x3e\x3c/div\x3e'),k.text(b.data[c][0]),k.css("transition","all .5s "+.2*c+"s"),r>h/2?k.css("left",r/2+5):k.css("right",(h-r)/2+5),m>e/2?k.css("top",m/2+5):k.css("bottom",(e-m)/2+5),b.data[c][2]&&k.css("color",b.data[c][2]),k.css("opacity",0),d.append(k));a.lineWidth=5;a.strokeStyle="#e0e0e0";a.stroke();a.closePath();c=document.createElement("canvas");a=c.getContext("2d");c.width=a.width=h;c.height=a.height=e;d.append(c);a.strokeStyle="#e87777";var t=function(c){1<=c&&d.find(".text").css("opacity",1);1>=c&&d.find(".text").css("opacity",0);a.clearRect(0,0,h,e);a.beginPath();a.lineWidth=20;for(var f=0;f<l;f++){var k=2*Math.PI/360*(360/l)*f,n=b.data[f][1]*c,m=g+Math.sin(k)*n*g,k=g+Math.cos(k)*n*g;a.lineTo(m,k)}a.closePath();a.stroke();a.fillStyle="#e87777";for(f=0;f<l;f++)k=2*Math.PI/360*(360/l)*f,n=b.data[f][1],m=g+Math.sin(k)*n*c*g,k=g+Math.cos(k)*n*c*g,a.beginPath(),a.arc(m,k,5,0,2*Math.PI),a.fill(),a.closePath()};d.on("afterLoad",function(){for(var a=0,b=0;100>b;b++)setTimeout(function(){a+=.01;t(a)},10*b+500)});d.on("onLeave",function(){for(var a=1,b=0;100>b;b++)setTimeout(function(){a-=.01;t(a)},10*b+500)});return d};